import{C as f,o as l,c,a as s,F as u,r as g,b as p,p as _,d as y,e as b,t as v,f as w,g as k}from"./vendor.cbf14d0e.js";const C=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const a of e)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function r(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?a.credentials="include":e.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(e){if(e.ep)return;e.ep=!0;const a=r(e);fetch(e.href,a)}};C();var D=(t,n)=>{const r=t.__vccOpts||t;for(const[i,e]of n)r[i]=e;return r};async function m(t,n,r){const i=[];for await(let e of t.values())r?!e.name.match(r)&&e.name.match(n)&&i.push(e):e.name.match(n)&&i.push(e);return i}async function F(t,n,r){const e=await(await n.getFileHandle(r,{create:!0})).createWritable({});await e.write(t),await e.close()}let d=null;const I={data(){return{files:[],parent:null,editing:null,thumbs:[]}},methods:{async findThumbs(){this.thumbs=await m(this.parent,/.+\.thumb\.webp/)},async openDir(){this.parent=await window.showDirectoryPicker(),!!this.parent&&(this.files=await m(this.parent,/.+\.(png|jpg|jpeg)/,/.+\.thumb\.webp/),this.findThumbs())},async loadCropper(t){let n=new FileReader;n.onload=async()=>{const r=n.result,i=new Image;i.src=r,d.replace(r),this.editing=t},n.readAsDataURL(await t.getFile())},crop(){d.getCroppedCanvas({width:600,height:600,minWidth:600,minHeight:600,maxWidth:4096,maxHeight:4096,fillColor:"#fff",imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}).toBlob(async t=>{await F(t,this.parent,this.editing.name+".thumb.webp"),await this.findThumbs()},"image/webp",.7)}},computed:{hasThumbnail(){return this.thumbs.map(t=>t.name.replace(".thumb.png",".png"))}},mounted(){const t=document.getElementById("image");d=new f(t,{aspectRatio:1,crop(n){}})}},S=t=>(_("data-v-fe208166"),t=t(),y(),t),x={class:"file-pane"},L=["onClick"],T={key:0},B={class:"image-pane"},N={key:0},O=S(()=>s("img",{id:"image"},null,-1));function H(t,n,r,i,e,a){return l(),c(u,null,[s("div",x,[s("button",{onClick:n[0]||(n[0]=(...o)=>a.openDir&&a.openDir(...o))},"Open Dir"),s("div",null,[(l(!0),c(u,null,g(e.files,(o,h)=>(l(),c("div",{class:"item",key:h,onClick:E=>a.loadCropper(o)},[b(v(o.name)+" ",1),a.hasThumbnail.includes(o.name)?(l(),c("span",T,"\u2714")):p("",!0)],8,L))),128))])]),s("div",B,[s("div",null,[e.editing?(l(),c("div",N,[s("button",{onClick:n[1]||(n[1]=(...o)=>a.crop&&a.crop(...o))},"Save Thumbnail")])):p("",!0)]),O])],64)}var W=D(I,[["render",H],["__scopeId","data-v-fe208166"]]);const A={setup(t){return(n,r)=>(l(),w(W))}};k(A).mount("#app");
